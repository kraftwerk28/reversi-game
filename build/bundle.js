var app=function(){"use strict";function t(){}const e=t=>t;function n(t){return t()}function o(){return Object.create(null)}function s(t){t.forEach(n)}function r(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e}function i(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}const u="undefined"!=typeof window;let a=u?()=>window.performance.now():()=>Date.now(),f=u?t=>requestAnimationFrame(t):t;const d=new Set;function p(t){d.forEach((e=>{e.c(t)||(d.delete(e),e.f())})),0!==d.size&&f(p)}function $(t,e){t.appendChild(e)}function h(t,e,n){t.insertBefore(e,n||null)}function m(t){t.parentNode.removeChild(t)}function g(t){return document.createElement(t)}function v(t){return document.createTextNode(t)}function b(){return v(" ")}function _(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function y(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function E(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function x(t,e,n){t.classList[n?"add":"remove"](e)}const w=new Set;let C,B=0;function T(t,e,n,o,s,r,l,c=0){const i=16.666/o;let u="{\n";for(let t=0;t<=1;t+=i){const o=e+(n-e)*r(t);u+=100*t+`%{${l(o,1-o)}}\n`}const a=u+`100% {${l(n,1-n)}}\n}`,f=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(a)}_${c}`,d=t.ownerDocument;w.add(d);const p=d.__svelte_stylesheet||(d.__svelte_stylesheet=d.head.appendChild(g("style")).sheet),$=d.__svelte_rules||(d.__svelte_rules={});$[f]||($[f]=!0,p.insertRule(`@keyframes ${f} ${a}`,p.cssRules.length));const h=t.style.animation||"";return t.style.animation=`${h?h+", ":""}${f} ${o}ms linear ${s}ms 1 both`,B+=1,f}function A(t,e){const n=(t.style.animation||"").split(", "),o=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),s=n.length-o.length;s&&(t.style.animation=o.join(", "),B-=s,B||f((()=>{B||(w.forEach((t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}})),w.clear())})))}function N(t){C=t}const W=[],O=[],I=[],k=[],L=Promise.resolve();let q=!1;function K(t){I.push(t)}let z=!1;const H=new Set;function M(){if(!z){z=!0;do{for(let t=0;t<W.length;t+=1){const e=W[t];N(e),R(e.$$)}for(N(null),W.length=0;O.length;)O.pop()();for(let t=0;t<I.length;t+=1){const e=I[t];H.has(e)||(H.add(e),e())}I.length=0}while(W.length);for(;k.length;)k.pop()();q=!1,z=!1,H.clear()}}function R(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(K)}}let j;function S(t,e,n){t.dispatchEvent(function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(`${e?"intro":"outro"}${n}`))}const P=new Set;let D;function X(){D={r:0,c:[],p:D}}function F(){D.r||s(D.c),D=D.p}function Y(t,e){t&&t.i&&(P.delete(t),t.i(e))}function G(t,e,n,o){if(t&&t.o){if(P.has(t))return;P.add(t),D.c.push((()=>{P.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}const J={duration:0};function Q(n,o,l,c){let i=o(n,l),u=c?0:1,$=null,h=null,m=null;function g(){m&&A(n,m)}function v(t,e){const n=t.b-u;return e*=Math.abs(n),{a:u,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function b(o){const{delay:r=0,duration:l=300,easing:c=e,tick:b=t,css:_}=i||J,y={start:a()+r,b:o};o||(y.group=D,D.r+=1),$||h?h=y:(_&&(g(),m=T(n,u,o,l,r,c,_)),o&&b(0,1),$=v(y,l),K((()=>S(n,o,"start"))),function(t){let e;0===d.size&&f(p),new Promise((n=>{d.add(e={c:t,f:n})}))}((t=>{if(h&&t>h.start&&($=v(h,l),h=null,S(n,$.b,"start"),_&&(g(),m=T(n,u,$.b,$.duration,0,c,i.css))),$)if(t>=$.end)b(u=$.b,1-u),S(n,$.b,"end"),h||($.b?g():--$.group.r||s($.group.c)),$=null;else if(t>=$.start){const e=t-$.start;u=$.a+$.d*c(e/$.duration),b(u,1-u)}return!(!$&&!h)})))}return{run(t){r(i)?(j||(j=Promise.resolve(),j.then((()=>{j=null}))),j).then((()=>{i=i(),b(t)})):b(t)},end(){g(),$=h=null}}}function U(t){t&&t.c()}function V(t,e,o){const{fragment:l,on_mount:c,on_destroy:i,after_update:u}=t.$$;l&&l.m(e,o),K((()=>{const e=c.map(n).filter(r);i?i.push(...e):s(e),t.$$.on_mount=[]})),u.forEach(K)}function Z(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function tt(t,e){-1===t.$$.dirty[0]&&(W.push(t),q||(q=!0,L.then(M)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function et(e,n,r,l,c,i,u=[-1]){const a=C;N(e);const f=n.props||{},d=e.$$={fragment:null,ctx:null,props:i,update:t,not_equal:c,bound:o(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:o(),dirty:u,skip_bound:!1};let p=!1;if(d.ctx=r?r(e,f,((t,n,...o)=>{const s=o.length?o[0]:n;return d.ctx&&c(d.ctx[t],d.ctx[t]=s)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](s),p&&tt(e,t)),n})):[],d.update(),p=!0,s(d.before_update),d.fragment=!!l&&l(d.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);d.fragment&&d.fragment.l(t),t.forEach(m)}else d.fragment&&d.fragment.c();n.intro&&Y(e.$$.fragment),V(e,n.target,n.anchor),M()}N(a)}class nt{$destroy(){Z(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const ot={NONE:0,BLACK:1,WHITE:2,BLACK_WON:3,WHITE_WON:4,TIE:5},st=(t,e)=>8*e+t,rt=[[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1],[0,-1],[1,-1]];function lt(t){const{move:e,board:n}=t,o=new Map;let s=e===ot.BLACK?ot.WHITE:ot.BLACK;return n.map(((t,e)=>[t,e])).filter((([t])=>t===e)).forEach((([t,e])=>{const[r,l]=(t=>[t%8,t/8|0])(e);rt.forEach((([t,e])=>{let c=[];for(let i=r+t,u=l+e;i>=0&&i<8&&u>=0&&l<8;i+=t,u+=e){const t=st(i,u),e=n[t];if(e!==s){if(e===ot.NONE){c.length&&o.set(t,c.concat(o.get(t)||[]));break}break}c.push(t)}}))})),o}function ct(){const t=Array(64).fill(ot.NONE);t[st(3,3)]=t[st(4,4)]=ot.WHITE,t[st(4,3)]=t[st(3,4)]=ot.BLACK;const e={move:ot.BLACK,board:t,pass:!1};return e.possibleMoves=lt(e),e}function it(t){let e,n,o;return{c(){e=g("div"),y(e,"class","disc b svelte-1pbl36q")},m(t,n){h(t,e,n),o=!0},i(s){o||(K((()=>{n||(n=Q(e,t[0],{},!0)),n.run(1)})),o=!0)},o(s){n||(n=Q(e,t[0],{},!1)),n.run(0),o=!1},d(t){t&&m(e),t&&n&&n.end()}}}function ut(t){let e,n,o;return{c(){e=g("div"),y(e,"class","disc w svelte-1pbl36q")},m(t,n){h(t,e,n),o=!0},i(s){o||(K((()=>{n||(n=Q(e,t[0],{},!0)),n.run(1)})),o=!0)},o(s){n||(n=Q(e,t[0],{},!1)),n.run(0),o=!1},d(t){t&&m(e),t&&n&&n.end()}}}function at(t){let e,n,o,s,r,l=t[1]===ot.BLACK&&it(t),c=t[1]===ot.WHITE&&ut(t);return{c(){e=g("div"),l&&l.c(),n=b(),c&&c.c(),y(e,"class","root svelte-1pbl36q")},m(i,u){h(i,e,u),l&&l.m(e,null),$(e,n),c&&c.m(e,null),o=!0,s||(r=_(e,"click",t[2]),s=!0)},p(t,[o]){t[1]===ot.BLACK?l?2&o&&Y(l,1):(l=it(t),l.c(),Y(l,1),l.m(e,n)):l&&(X(),G(l,1,1,(()=>{l=null})),F()),t[1]===ot.WHITE?c?2&o&&Y(c,1):(c=ut(t),c.c(),Y(c,1),c.m(e,null)):c&&(X(),G(c,1,1,(()=>{c=null})),F())},i(t){o||(Y(l),Y(c),o=!0)},o(t){G(l),G(c),o=!1},d(t){t&&m(e),l&&l.d(),c&&c.d(),s=!1,r()}}}function ft(t,e,n){let{color:o}=e;return t.$$set=t=>{"color"in t&&n(1,o=t.color)},[(t,{duration:e=300})=>({duration:e,css:(t,e)=>`\n      transform: rotateX(${.5*t}turn)\n                 scale(${2*(t>=.5?e:t)+1});\n      visibility: ${t>=.5?"visible":"hidden"};\n    `}),o,function(e){!function(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t(e)))}(t,e)}]}class dt extends nt{constructor(t){super(),et(this,t,ft,at,l,{swapTrn:0,color:1})}get swapTrn(){return this.$$.ctx[0]}}const pt=[];function $t(e,n=t){let o;const s=[];function r(t){if(l(e,t)&&(e=t,o)){const t=!pt.length;for(let t=0;t<s.length;t+=1){const n=s[t];n[1](),pt.push(n,e)}if(t){for(let t=0;t<pt.length;t+=2)pt[t][0](pt[t+1]);pt.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(l,c=t){const i=[l,c];return s.push(i),1===s.length&&(o=n(r)||t),l(e),()=>{const t=s.indexOf(i);-1!==t&&s.splice(t,1),0===s.length&&(o(),o=null)}}}}const ht=$t(ct());function mt(t){return t.move===ot.BLACK?ot.WHITE:ot.BLACK}function gt(t){ht.update((e=>{const n=e.possibleMoves.get(t);if(!n)return e;const o=e.board.slice();o[t]=e.move;for(const t of n)o[t]=e.move;return e.move=mt(e),e.board=o,e.possibleMoves=lt(e),{...e}})),ht.update((t=>{const{board:e,possibleMoves:n}=t;if(e.every((t=>t!==ot.NONE))){const n=e.reduce(((t,e)=>t+(e===ot.BLACK?1:0)),0);return t.move=32===n?ot.TIE:n>32?ot.BLACK_WON:ot.WHITE_WON,{...t}}return 0===n.size?(t.pass?t.move=ot.TIE:(t.move=mt(t),t.pass=!0),{...t}):t}))}function vt(){ht.set(ct())}function bt(t){let e,n,o,s,r;return{c(){e=g("div"),n=g("h1"),o=v(t[0]),y(n,"class","svelte-1x575e7"),y(e,"class","root svelte-1x575e7")},m(t,l){h(t,e,l),$(e,n),$(n,o),s||(r=_(e,"click",vt),s=!0)},p(t,e){1&e&&E(o,t[0])},d(t){t&&m(e),s=!1,r()}}}function _t(e){let n,o=e[1]&&bt(e);return{c(){o&&o.c(),n=v("")},m(t,e){o&&o.m(t,e),h(t,n,e)},p(t,[e]){t[1]?o?o.p(t,e):(o=bt(t),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},i:t,o:t,d(t){o&&o.d(t),t&&m(n)}}}function yt(t,e,n){let o,s,r;return i(t,ht,(t=>n(2,o=t))),t.$$.update=()=>{if(4&t.$$.dirty&&n(1,r=[ot.TIE,ot.BLACK_WON,ot.WHITE_WON].includes(o.move)),4&t.$$.dirty)if(o.move===ot.TIE)n(0,s="🤷Tie!");else{const t=o.move===ot.WHITE_WON?"🌝":"🌚";n(0,s=t+" won!")}},[s,r]}class Et extends nt{constructor(t){super(),et(this,t,yt,_t,l,{})}}function xt(e){let n;return{c(){n=g("div"),y(n,"class","marker svelte-i8r4tq"),y(n,"style",e[0]),x(n,"allow",e[1]),x(n,"visible",e[2].visible)},m(t,e){h(t,n,e)},p(t,[e]){1&e&&y(n,"style",t[0]),2&e&&x(n,"allow",t[1]),4&e&&x(n,"visible",t[2].visible)},i:t,o:t,d(t){t&&m(n)}}}const wt=$t({visible:!1});function Ct(){wt.update((t=>({...t,visible:!1})))}function Bt(t,e,n){let o,s;i(t,ht,(t=>n(4,o=t))),i(t,wt,(t=>n(2,s=t)));let r,{fieldBounds:l}=e,c="";return t.$$set=t=>{"fieldBounds"in t&&n(3,l=t.fieldBounds)},t.$$.update=()=>{if(20&t.$$.dirty&&n(1,r=o.possibleMoves.has(st(s.x,s.y))),12&t.$$.dirty&&l){const{x:t,y:e}=s;n(0,c=`\n        left: ${t/8*(l.width-14)+2*t}px;\n        top: ${e/8*(l.height-14)+2*e}px;\n      `)}},[c,r,s,l]}class Tt extends nt{constructor(t){super(),et(this,t,Bt,xt,l,{fieldBounds:3})}}function At(t,e,n){const o=t.slice();return o[10]=e[n],o[12]=n,o}function Nt(t){let e,n;return e=new dt({props:{color:t[10]}}),e.$on("click",(function(...e){return t[7](t[12],...e)})),{c(){U(e.$$.fragment)},m(t,o){V(e,t,o),n=!0},p(n,o){t=n;const s={};8&o&&(s.color=t[10]),e.$set(s)},i(t){n||(Y(e.$$.fragment,t),n=!0)},o(t){G(e.$$.fragment,t),n=!1},d(t){Z(e,t)}}}function Wt(t){let e,n,o,r,l,c,i,u,a,f,d,p,w,C,B,T,A,N,W,O,I,k,L,q,K=t[3].board,z=[];for(let e=0;e<K.length;e+=1)z[e]=Nt(At(t,K,e));const H=t=>G(z[t],1,1,(()=>{z[t]=null}));return W=new Tt({props:{fieldBounds:t[1]}}),I=new Et({}),{c(){e=g("div"),n=g("div"),o=g("span"),o.textContent="🌚",r=b(),l=g("span"),l.textContent="👈",c=b(),i=g("span"),i.textContent="🌝",u=b(),a=g("span"),a.textContent=" ",f=b(),d=g("span"),d.textContent="⚪",p=b(),w=g("span"),C=v("x"),B=v(t[4]),T=b(),A=g("div");for(let t=0;t<z.length;t+=1)z[t].c();N=b(),U(W.$$.fragment),O=b(),U(I.$$.fragment),y(o,"class","svelte-1gq2pz0"),y(l,"class","svelte-1gq2pz0"),x(l,"iswhite",t[2]),y(i,"class","svelte-1gq2pz0"),y(a,"class","svelte-1gq2pz0"),y(d,"class","svelte-1gq2pz0"),y(w,"class","svelte-1gq2pz0"),y(n,"class","game-status svelte-1gq2pz0"),y(A,"class","field-root svelte-1gq2pz0"),x(A,"blurred",t[5]),y(e,"class","field-container svelte-1gq2pz0")},m(s,m){h(s,e,m),$(e,n),$(n,o),$(n,r),$(n,l),$(n,c),$(n,i),$(n,u),$(n,a),$(n,f),$(n,d),$(n,p),$(n,w),$(w,C),$(w,B),$(e,T),$(e,A);for(let t=0;t<z.length;t+=1)z[t].m(A,null);$(A,N),V(W,A,null),t[8](A),$(e,O),V(I,e,null),k=!0,L||(q=[_(window,"resize",t[6]),_(A,"mousemove",t[9]),_(A,"mouseleave",Ct)],L=!0)},p(t,[e]){if(4&e&&x(l,"iswhite",t[2]),(!k||16&e)&&E(B,t[4]),8&e){let n;for(K=t[3].board,n=0;n<K.length;n+=1){const o=At(t,K,n);z[n]?(z[n].p(o,e),Y(z[n],1)):(z[n]=Nt(o),z[n].c(),Y(z[n],1),z[n].m(A,N))}for(X(),n=K.length;n<z.length;n+=1)H(n);F()}const n={};2&e&&(n.fieldBounds=t[1]),W.$set(n),32&e&&x(A,"blurred",t[5])},i(t){if(!k){for(let t=0;t<K.length;t+=1)Y(z[t]);Y(W.$$.fragment,t),Y(I.$$.fragment,t),k=!0}},o(t){z=z.filter(Boolean);for(let t=0;t<z.length;t+=1)G(z[t]);G(W.$$.fragment,t),G(I.$$.fragment,t),k=!1},d(n){n&&m(e),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(z,n),Z(W),t[8](null),Z(I),L=!1,s(q)}}}function Ot(t,e,n){let o,s,r;function l(){n(1,r=s?.getBoundingClientRect())}i(t,ht,(t=>n(3,o=t)));let c,u,a;return t.$$.update=()=>{1&t.$$.dirty&&l(),8&t.$$.dirty&&n(2,c=o.move===ot.WHITE),8&t.$$.dirty&&n(4,u=64-o.board.filter((t=>t>0)).length),8&t.$$.dirty&&n(5,a=[ot.TIE,ot.BLACK_WON,ot.WHITE_WON].includes(o.move))},[s,r,c,o,u,a,l,t=>gt(t),function(t){O[t?"unshift":"push"]((()=>{s=t,n(0,s)}))},t=>function(t,e){const{left:n,top:o,width:s,height:r}=e,{clientX:l,clientY:c}=t,[i,u]=[(l-n)/s*8|0,(c-o)/r*8|0];wt.update((t=>i===t.x&&u===t.y&&t.visible?t:{...t,x:i,y:u,visible:!0}))}(t,r)]}class It extends nt{constructor(t){super(),et(this,t,Ot,Wt,l,{})}}function kt(e){let n,o;return n=new It({}),{c(){U(n.$$.fragment)},m(t,e){V(n,t,e),o=!0},p:t,i(t){o||(Y(n.$$.fragment,t),o=!0)},o(t){G(n.$$.fragment,t),o=!1},d(t){Z(n,t)}}}return new class extends nt{constructor(t){super(),et(this,t,null,kt,c,{})}}({target:document.body})}();
